type: custom:auto-entities
card:
  type: custom:flex-table-card
  title: Wine Cellar
  clickable: true
  unsafe_render_html: true
  columns:
    - name: Wine
      data: Wine
    - name: Vintage
      data: Vintage
    - name: Rack
      data: state
    - name: Bin
      data: Bin
    - name: Country
      data: Country
    - name: Drink From
      data: BeginConsume
      modify: |
        (() => {
          const year = new Date().getFullYear();
          const val = parseInt(x);
          if (!x || isNaN(val)) return '—';
          const color = val > year ? '#f44336' : '#4CAF50';
          return `<span style="color:${color}">${x}</span>`;
        })()        
    - name: Drink By
      data: EndConsume
      modify: |
        (() => {
          const year = new Date().getFullYear();
          const val = parseInt(x);
          if (!x || isNaN(val)) return '—';
          const color = val > year ? '#4CAF50' : '#f44336';
         return `<span style="color:${color}">${x}</span>`;
        })()      
    - name: Value
      data: Valuation
      modify: parseFloat(x).toFixed(0)
filter:
  include:
    - options: {}
      entity_id: sensor.cellartracker_*
  exclude:
    - options: {}
      entity_id: sensor.cellartracker_total_bottles
    - options: {}
      entity_id: sensor.cellartracker_total_value
sort:
  method: name
